https://event.cloudnativedays.jp/cndt2023/talks/2058

opelの軽装

1. アプリケーションにトレースのセットアップ
2. リクエストからトレース情報抽出
3. spanの生成
4. リクエストにトレース情報を注入

1. アプリケーションにメトリクスのセットアップ
2. メトリクスのロジック追加

grpcやredis,postgres,echoなどさまざまなパッケージに軽装ライブラリがある

****OpenTelemetryAPIやSFK各ツールの軽装ライブラリをくししてアプリケーションを軽装してテレメトリーを収集する****

## できることならアプリに手を加えず軽装　自動軽装したい

Goは自動軽装ツールは今のところない。Javaは対応している

コードに手をいれず環境変数でOtelの設定を行う。

自動軽装と手動軽装

自動軽装は痒いところに手が届かないかも。。アプリ固有の値はtraceID.spanに付与したいなどは手動

カスタムメトリクス生成のためは手動

自動軽装にライブラリが対応していない場合や、カスタムにスパンを追加したい場合は手動

Goでは手動軽装

どれだけ手動軽装を楽にするかが腕の見せ所

自動軽装も進んでいるが現状WIP opentelmetry-go-instrumentationでプロジェクト動いている

## kubernetesを使っている場合は Kubernetes Operatorを使った自動軽装できる

- Instrumentation
- 自動軽装はGo,Java、Nginx,Pythonなど
- サイドカーとしてenvoyを注入してあげる
- マニフェストに自動軽装のあのケーションを加える。アプリケーションには軽装する必要なし
- アプリケーションサイドは軽装する考慮をする必要がない。
